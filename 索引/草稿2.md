更新逻辑分为更新属性，更新children
# patch children
children 类型可能为 text，array

| 老节点类型 | 新节点类型 | 处理方式                      |
| ---------- | ---------- | ----------------------------- |
| array      | text       | 清空老节点的数组，赋值新text  |
| text       | array      | 清空老节点的text，赋值新array |
| text       | text       | 清空老节点的text, 赋值新text  |
| array      | array      | 双端对比 diff 算法                              |

## 双端对比 diff 算法(新旧节点都是 array)
#### 目的，算出中间乱序节点的范围
先找到左边相同的节点，在找到右边相同的节点，最终找到中间不同的节点
![](Pasted%20image%2020220501092806.png)
- 创建新的 d
- 删除老的 y
- 移动位置的 c e

`约定,起点指针i, 旧节点尾 e1, 新节点尾 e2`

1. 情况 1 处理左侧
![](Pasted%20image%2020220501163414.png)

2. 情况 2 处理右侧
 ![](Pasted%20image%2020220501163319.png)
 
 3. 左右移动后，新的比老的多
 ![](Pasted%20image%2020220501162749.png)
 
 4. 左右移动后，老的比新的多
![](Pasted%20image%2020220501163855.png)






















## 1 同步头，相同的patch，不同截止
## 2 同步尾，相同的patch，不同截止
## 3 ![](Pasted%20image%2020220430193051.png)
#### s1 >e1 && s1 <= e2 添加条件
索引 i 开始到索引 e2 之间，我们直接挂载新子树这部分的节点。
#### s1>e2 && s1<=e1 删除条件
删除旧节点 s1 到 e1
#### 未知子序列




![](Pasted%20image%2020220430200236.png)